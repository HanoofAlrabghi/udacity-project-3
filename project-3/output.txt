Query of First Question:

news=> create view qmostartview as select articles.title, subq.views from ( 
select subq1.slug, count(*) as views from ( select articles.slug, log.path from
articles cross join log where log.path like ('%'|| articles.slug ||'%')) as subq1 
group by subq1.slug) as subq cross join articles where
articles.slug = subq.slug order by subq.views desc limit 3;
CREATE VIEW

news=> select * from qmostartview;
              title               | views
----------------------------------+--------
 Candidate is jerk, alleges rival | 342102
 Bears love berries, alleges bear | 256365
 Bad things gone, say good people | 171762
(3 rows)
___________________________________________________________________________________

Query of second Question:

news=> create view qpopaut as select authors.name, subq.views from ( select
subq1.slug, count(*) as views from ( select articles.slug, log.path from 
articles cross join log where log.path like ('%'|| articles.slug ||'%'))
as subq1 group by subq1.slug) as subq cross join articles, authors where 
articles.author = authors.id and articles.slug = subq.slug order by subq.views desc;
CREATE VIEW

news=> select * from qpopaut;
          name          | views
------------------------+--------
 Rudolf von Treppenwitz | 342102
 Ursula La Multa        | 256365
 Anonymous Contributor  | 171762
 Ursula La Multa        |  85775
 Rudolf von Treppenwitz |  85679
 Ursula La Multa        |  85392
 Markoff Chaney         |  85387
 Ursula La Multa        |  85273
(8 rows)
_____________________________________________________________________________________

Query of third Question:

news=> create view qdayerror as select concat(date_part('day', date(time)), '-',
date_part('month', date(time)), '-', date_part('year', date(time))) as Date, percentage
from ( select day, percentage from ( select qdayerr.day, qdayerr.errors * 100 / qdayall.views
as percentage from ( select date_part('day', date(time)) as day, count(*) as errors from 
log where status != '200 OK' group by day order by day) as qdayerr join (select
date_part('day', date(time)) as day, count(*) as views from log group by day order by day)
as qdayall on qdayerr.day = qdayall.day) as qr where percentage > 1) as qf join log on 
date_part('day', date(time)) = qf.day limit 1;
CREATE VIEW

news=> select * from qdayerror;
   date    | percentage
-----------+------------
 17-7-2016 |          2
(1 row)






